function hdStore(f){var d={},c=[],g=hdStore.prototype.events,i=this,e=function(a){for(var b=0;b<g.length;b++)if(g[b].type==a)for(var h in hdStore.Priorities)if(hdStore.Priorities[h].canBeUsed&&g[b].id==h)return g[b].handler.call(i,d);return false};this.id=f||"x-hdStore";this.getCount=function(){return d.__count__||c.length};this.setKey=function(a,b){if(!this.exists(a))throw Error(a+" does not exists");d[b]=d[a];for(var h=0;h<c.length;h++)if(c[h]===a){c[h]=b;break}this.remove(a)};this.getItem=function(a){return d[a]};
this.setItem=function(a,b){if(b)return d[a]=b;throw Error("No item provided");};this.add=function(a,b){if(this.exists(a))throw Error("Key "+a+" already exists in instance "+this.id+" of hdStore");else{d[a]=b;c.push(a)}};this.exists=function(a){return a in d};this.items=function(){for(var a=[],b=0;b<c.length;b++)a.push(d[c[b]]);return a};this.keys=function(){return c};this.remove=function(a){with(hdStore)delete d[a];for(var b=0;b<c.length;b++)if(c[b]===a){c.splice(b,1);break}};this.removeAll=function(){d=
{};c=[]};this.save=function(){return e("save")};this.load=function(){return e("load")}}hdStore.prototype.toString=function(){return this.id+" instance of hdStore"};hdStore.prototype.filter=function(f,d){for(var c=new hdStore(this.id),g=this.keys(),i=this.items(),e=0;e<this.getCount();e++)if(f.call(d||this,i[e],g[e]))c.add(g[e],i[e]);return c};hdStore.prototype.events=[];
hdStore.prototype.addHandler=function(f){if(f.type=="save"||f.type=="load")hdStore.prototype.events.push(f);else throw Error(f.type+" type not implemented.");};